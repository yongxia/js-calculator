{"version":3,"sources":["index.js"],"names":["MESSAGES","RESULT","CLEAR","addMessage","message","type","addResult","clear","INTIAL_STATE","equation","result","parser","isOperator","startsWithOperatorFollowedByNonNegative","startsWithOperatorFollowedByNegativeAndOperator","endsWithOperator","calculatorReducer","state","action","includes","test","substring","push","length","replace","match","expression","join","Math","round","eval","mapStateToProps","mapDispatchToProps","dispatch","addNewMessage","updateResult","reset","Presentational","props","resetHandler","clickHandler","e","target","value","clickEqualsHandler","bind","className","id","this","onClick","href","rel","React","Component","store","createStore","devToolsEnhancer","Container","connect","CalculatorWrapper","render","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.dbc1c641.chunk.js","sourcesContent":["\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createStore } from 'redux';\r\nimport { devToolsEnhancer } from 'redux-devtools-extension';\r\nimport { connect, Provider } from 'react-redux';\r\n\r\nimport './style.css';\r\n\r\n//Redux\r\nconst MESSAGES = 'MESSAGES',\r\n  RESULT = 'RESULT',\r\n  CLEAR = 'CLEAR';\r\n\r\nconst addMessage = message => ({\r\n  type: MESSAGES,\r\n  message\r\n});\r\n\r\nconst addResult = () => ({\r\n  type: RESULT\r\n});\r\n\r\nconst clear = () => ({\r\n  type: CLEAR\r\n});\r\n\r\nconst INTIAL_STATE = ({\r\n  equation: [], // store operators and numbers\r\n  result: 0,\r\n  parser: ''\r\n});\r\n\r\n\r\nconst isOperator = /[+*/-]/;\r\nconst startsWithOperatorFollowedByNonNegative = /^[+/*-][+/*]/;\r\nconst startsWithOperatorFollowedByNegativeAndOperator = /^[+*/-]-[+/*-]/;\r\nconst endsWithOperator = /\\d+[+*/-]$/;\r\n\r\nconst calculatorReducer = (state = INTIAL_STATE, action) => {\r\n  let equation = [...state.equation];\r\n  let parser = state.parser;\r\n  switch (action.type) {\r\n    case MESSAGES:\r\n      parser += action.message;\r\n      //case: use previous result\r\n      if (equation.includes('=')) {\r\n        equation = isOperator.test(action.message) ? [state.result] : [];\r\n      }\r\n      //case: reset to last operator \r\n      if (startsWithOperatorFollowedByNonNegative.test(parser)) { //(+/-* followed by +/*)\r\n        parser = parser.substring(1);\r\n      } else if (startsWithOperatorFollowedByNegativeAndOperator.test(parser)) {\r\n        parser = parser.substring(2);\r\n      } else if (!endsWithOperator.test(parser)) {\r\n        // hanlde multiple zeros in beging of a number, allow 0. for float\r\n        if (/^[+*/]?-?0+$/.test(parser)) {\r\n          parser = parser.replace(/0+/, '0');\r\n        } else if (/^[+*/]?-?0+[1-9]$/.test(parser)) {\r\n          parser = parser.replace(/0+/, '');\r\n        }\r\n        // only show one dot for float number\r\n        if ((parser.match(/\\./g) || []).length > 1) {\r\n          parser = parser.substring(0, parser.length - 1);\r\n        }\r\n      } else {\r\n        //meet condition for parsing, ends with at least one digit and an operator\r\n        //at the very beginng, there might not be an operator in parser\r\n        if (/^[+/*-]/.test(parser)) {\r\n          equation.push(parser[0]);\r\n          parser = parser.substring(1); //parse operator, '--1.23+' => '-1.23+', ['-']\r\n        }\r\n        //parse number part\r\n        equation.push(parser.substring(0, parser.length - 1));\r\n        //update parser for next parse\r\n        parser = parser[parser.length - 1];\r\n      }\r\n      return { ...state, equation: equation, parser: parser, result: parser };\r\n    case RESULT:\r\n      //parse remaining if any\r\n      if (/^[+*/-]/.test(parser)) {\r\n        equation.push(parser[0]);\r\n        parser = parser.substring(1);\r\n        if (parser.length > 0) {\r\n          equation.push(parser);\r\n          parser = '';\r\n        }\r\n      }\r\n      // no left or right hand number return current state\r\n      if (equation.length <= 2 || !/\\d$/.test(equation[equation.length - 1])) return state;\r\n\r\n      let expression = equation.join(' ');\r\n      // no left hand for first operator in expression, add 0\r\n      if (typeof equation[0] !== 'number') {\r\n        expression = '0 + ' + expression;\r\n      }\r\n      let result = Math.round(eval(expression) * 10000) / 10000;\r\n      equation.push('=', result);\r\n      return { ...state, equation: equation, parser: '', result: result };\r\n    case CLEAR:\r\n      return INTIAL_STATE;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    equation: state.equation,\r\n    result: state.result,\r\n    parser: state.parser\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    addNewMessage: message => { dispatch(addMessage(message)) },\r\n    updateResult: () => { dispatch(addResult()) },\r\n    reset: () => { dispatch(clear()) }\r\n  }\r\n}\r\n\r\n//React\r\nclass Presentational extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.resetHandler = this.resetHandler.bind(this);\r\n    this.clickHandler = this.clickHandler.bind(this);\r\n    this.clickEqualsHandler = this.clickEqualsHandler.bind(this);\r\n  }\r\n\r\n  resetHandler = () => {\r\n    this.props.reset();\r\n  }\r\n\r\n  clickHandler = e => {\r\n    this.props.addNewMessage(e.target.value);\r\n  }\r\n\r\n  clickEqualsHandler = () => {\r\n    this.props.updateResult();\r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <div className=\"container\">\r\n        <div className='box-group'>\r\n          <div className=\"screen\">\r\n            <div id=\"formula\">{this.props.equation.join('') + this.props.parser}</div>\r\n            <div id=\"display\">{this.props.result}</div>\r\n          </div>\r\n          <button id=\"clear\" onClick={this.resetHandler}>AC</button>\r\n          <button id=\"divide\" onClick={this.clickHandler} value=\"/\">/</button>\r\n          <button id=\"multiply\" onClick={this.clickHandler} value=\"*\">*</button>\r\n\r\n          <button id=\"seven\" onClick={this.clickHandler} value=\"7\">7</button>\r\n          <button id=\"eight\" onClick={this.clickHandler} value=\"8\">8</button>\r\n          <button id=\"nine\" onClick={this.clickHandler} value=\"9\">9</button>\r\n          <button id=\"add\" onClick={this.clickHandler} value=\"+\">+</button>\r\n\r\n          <button id=\"four\" onClick={this.clickHandler} value=\"4\">4</button>\r\n          <button id=\"five\" onClick={this.clickHandler} value=\"5\">5</button>\r\n          <button id=\"six\" onClick={this.clickHandler} value=\"6\">6</button>\r\n          <button id=\"subtract\" onClick={this.clickHandler} value=\"-\">-</button>\r\n\r\n          <button id=\"one\" onClick={this.clickHandler} value=\"1\">1</button>\r\n          <button id=\"two\" onClick={this.clickHandler} value=\"2\">2</button>\r\n          <button id=\"three\" onClick={this.clickHandler} value=\"3\">3</button>\r\n\r\n          <button id=\"equals\" onClick={this.clickEqualsHandler}>=</button>\r\n          <button id=\"zero\" onClick={this.clickHandler} value=\"0\">0</button>\r\n          <button id=\"decimal\" onClick={this.clickHandler} value=\".\">.</button>\r\n        </div>\r\n        <p>Coded by Yong Xia <a href=\"https://github.com/yongxia/js-calculator\" target=\"_blank\" rel=\"noreferrer\"><i className=\"fa fa-github\"></i> Github</a></p>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n//react-dedux\r\nconst store = createStore(calculatorReducer, devToolsEnhancer());\r\nconst Container = connect(mapStateToProps, mapDispatchToProps)(Presentational);\r\n\r\nclass CalculatorWrapper extends React.Component {\r\n  render = () => (\r\n    <Provider store={store}>\r\n      <Container />\r\n    </Provider>\r\n  )\r\n}\r\n\r\nReactDOM.render(<CalculatorWrapper />, document.getElementById('root'))"],"sourceRoot":""}