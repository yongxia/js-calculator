{"version":3,"sources":["index.js"],"names":["MESSAGES","RESULT","CLEAR","INTIAL_STATE","messages","result","parser","Presentational","props","resetHandler","reset","clickHandler","e","addNewMessage","target","value","clickEqualsHandler","updateResult","bind","className","id","this","join","onClick","href","rel","React","Component","store","createStore","state","action","type","includes","test","message","substr","push","charAt","substring","parseFloat","length","parseInt","replace","match","unshift","reduced","i","left","operator","right","Math","round","splice","console","log","devToolsEnhancer","Container","connect","dispatch","addMessage","CalculatorWrapper","render","ReactDOM","document","getElementById"],"mappings":"2PASMA,EAAW,WACfC,EAAS,SACTC,EAAQ,QAeJC,EAAgB,CACpBC,SAAU,GACVC,OAAQ,EACRC,OAAQ,IAkIJC,E,kDACJ,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IAMRC,aAAe,WACb,EAAKD,MAAME,SARM,EAWnBC,aAAe,SAAAC,GACb,EAAKJ,MAAMK,cAAcD,EAAEE,OAAOC,QAZjB,EAenBC,mBAAqB,WACnB,EAAKR,MAAMS,gBAdX,EAAKR,aAAe,EAAKA,aAAaS,KAAlB,gBACpB,EAAKP,aAAe,EAAKA,aAAaO,KAAlB,gBACpB,EAAKF,mBAAqB,EAAKA,mBAAmBE,KAAxB,gBAJT,E,0CAmBnB,WAEE,OACE,sBAAKC,UAAU,YAAf,UACE,sBAAKA,UAAU,YAAf,UACE,sBAAKA,UAAU,SAAf,UACE,qBAAKC,GAAG,UAAR,SAAmBC,KAAKb,MAAMJ,SAASkB,KAAK,IAAMD,KAAKb,MAAMF,SAC7D,qBAAKc,GAAG,UAAR,SAAmBC,KAAKb,MAAMH,YAEhC,wBAAQe,GAAG,QAAQG,QAASF,KAAKZ,aAAjC,gBACA,wBAAQW,GAAG,SAASG,QAASF,KAAKV,aAAcI,MAAM,IAAtD,eACA,wBAAQK,GAAG,WAAWG,QAASF,KAAKV,aAAcI,MAAM,IAAxD,eAEA,wBAAQK,GAAG,QAAQG,QAASF,KAAKV,aAAcI,MAAM,IAArD,eACA,wBAAQK,GAAG,QAAQG,QAASF,KAAKV,aAAcI,MAAM,IAArD,eACA,wBAAQK,GAAG,OAAOG,QAASF,KAAKV,aAAcI,MAAM,IAApD,eACA,wBAAQK,GAAG,MAAMG,QAASF,KAAKV,aAAcI,MAAM,IAAnD,eAEA,wBAAQK,GAAG,OAAOG,QAASF,KAAKV,aAAcI,MAAM,IAApD,eACA,wBAAQK,GAAG,OAAOG,QAASF,KAAKV,aAAcI,MAAM,IAApD,eACA,wBAAQK,GAAG,MAAMG,QAASF,KAAKV,aAAcI,MAAM,IAAnD,eACA,wBAAQK,GAAG,WAAWG,QAASF,KAAKV,aAAcI,MAAM,IAAxD,eAEA,wBAAQK,GAAG,MAAMG,QAASF,KAAKV,aAAcI,MAAM,IAAnD,eACA,wBAAQK,GAAG,MAAMG,QAASF,KAAKV,aAAcI,MAAM,IAAnD,eACA,wBAAQK,GAAG,QAAQG,QAASF,KAAKV,aAAcI,MAAM,IAArD,eAEA,wBAAQK,GAAG,SAASG,QAASF,KAAKL,mBAAlC,eACA,wBAAQI,GAAG,OAAOG,QAASF,KAAKV,aAAcI,MAAM,IAApD,eACA,wBAAQK,GAAG,UAAUG,QAASF,KAAKV,aAAcI,MAAM,IAAvD,kBAEF,mDAAqB,oBAAGS,KAAK,2CAA2CV,OAAO,SAASW,IAAI,aAAvE,UAAoF,mBAAGN,UAAU,iBAAjG,uB,GAnDAO,IAAMC,WA0D7BC,EAAQC,uBAxLY,WAAmC,IAAlCC,EAAiC,uDAAzB3B,EAAc4B,EAAW,uCACtD3B,EAAQ,YAAO0B,EAAM1B,UACrBE,EAASwB,EAAMxB,OACnB,OAAQyB,EAAOC,MACb,KAAKhC,EA0CH,OAzCII,EAAS6B,SAAS,OAElB7B,EADE,SAAS8B,KAAKH,EAAOI,SACZ,CAACL,EAAMzB,QAEP,IAGfC,GAAUyB,EAAOI,QAEb,eAAeD,KAAK5B,GACtBA,EAASA,EAAO8B,OAAO,GAEd,iBAAiBF,KAAK5B,GAC/BA,EAASA,EAAO8B,OAAO,GACZ,aAAaF,KAAK5B,IAczB,UAAU4B,KAAK5B,KACjBF,EAASiC,KAAK/B,EAAOgC,OAAO,IAC5BhC,EAASA,EAAOiC,UAAU,IAGxBjC,EAAO2B,SAAS,KAClB7B,EAASiC,KAAKG,WAAWlC,EAAOiC,UAAU,EAAGjC,EAAOmC,OAAS,KAE7DrC,EAASiC,KAAKK,SAASpC,EAAOiC,UAAU,EAAGjC,EAAOmC,OAAS,KAG7DnC,EAASA,EAAOiC,UAAUjC,EAAOmC,OAAS,KAvBtC,eAAeP,KAAK5B,GACtBA,EAASA,EAAOqC,QAAQ,KAAM,KACrB,oBAAoBT,KAAK5B,KAClCA,EAASA,EAAOqC,QAAQ,KAAM,MAG3BrC,EAAOsC,MAAM,QAAU,IAAIH,OAAS,IACvCnC,EAASA,EAAOiC,UAAU,EAAGjC,EAAOmC,OAAS,KAkB1C,2BAAKX,GAAZ,IAAmB1B,SAAUA,EAAUE,OAAQA,EAAQD,OAAQC,IACjE,KAAKL,EAmBH,GAjBI,UAAUiC,KAAK5B,KACjBF,EAASiC,KAAK/B,EAAOgC,OAAO,KAC5BhC,EAASA,EAAOiC,UAAU,IACfE,OAAS,IACdnC,EAAO2B,SAAS,KAClB7B,EAASiC,KAAKG,WAAWlC,IAEzBF,EAASiC,KAAKK,SAASpC,IAEzBA,EAAS,KAIc,kBAAhBF,EAAS,IAClBA,EAASyC,QAAQ,GAGfzC,EAASqC,QAAU,GAA8C,kBAAlCrC,EAASA,EAASqC,OAAS,GAAiB,OAAOX,EAItF,IADA,IAAIgB,EAAO,YAAO1C,GACX0C,EAAQb,SAAS,MAAQa,EAAQb,SAAS,MAAM,CAErD,IADA,IAAIc,EAAI,EACDA,EAAID,EAAQL,OAAS,GAAG,CAC7B,GAAI,QAAQP,KAAKY,EAAQC,IAAK,CAC5B,IAAIC,EAAOF,EAAQC,EAAI,GACnBE,EAAWH,EAAQC,GACnBG,EAAQJ,EAAQC,EAAI,GACpB1C,EAAsB,MAAb4C,EAAmBE,KAAKC,MAAMJ,EAAOE,EAAQ,KAAS,IAAQC,KAAKC,MAAMJ,EAAOE,EAAQ,KAAS,IAC9GJ,EAAQO,OAAON,EAAI,EAAG,EAAG1C,GAE3B0C,IAEFO,QAAQC,IAAI,UAAWT,GAGzB,KAAOA,EAAQb,SAAS,MAAQa,EAAQb,SAAS,MAAM,CAErD,IADA,IAAIc,EAAI,EACDA,EAAID,EAAQL,OAAS,GAC1B,GAAI,QAAQP,KAAKY,EAAQC,IAAK,CAC5B,IAAIC,EAAOF,EAAQC,EAAI,GACnBE,EAAWH,EAAQC,GACnBG,EAAQJ,EAAQC,EAAI,GACpB1C,EAAsB,MAAb4C,EAAmBE,KAAKC,MAAuB,KAAhBJ,EAAOE,IAAkB,IAAQC,KAAKC,MAAuB,KAAhBJ,EAAOE,IAAkB,IAClHJ,EAAQO,OAAON,EAAI,EAAG,EAAG1C,GAG7B0C,IACAO,QAAQC,IAAI,UAAWT,GAEzB,IAAIzC,EAASyC,EAAQ,GAErB,OADA1C,EAASiC,KAAK,IAAKhC,GACZ,2BAAKyB,GAAZ,IAAmB1B,SAAUA,EAAUE,OAAQ,GAAID,OAAQA,IAC7D,KAAKH,EACH,OAAOC,EACT,QACE,OAAO2B,KA+EgC0B,8BACvCC,EAAYC,aA5EM,SAAA5B,GACtB,MAAO,CACL1B,SAAU0B,EAAM1B,SAChBC,OAAQyB,EAAMzB,OACdC,OAAQwB,EAAMxB,WAIS,SAAAqD,GACzB,MAAO,CACL9C,cAAe,SAAAsB,GAAawB,EA3Ib,SAAAxB,GAAO,MAAK,CAC7BH,KAAMhC,EACNmC,WAyIuCyB,CAAWzB,KAChDlB,aAAc,WAAQ0C,EAvID,CACvB3B,KAAM/B,KAuIJS,MAAO,WAAQiD,EApIE,CACnB3B,KAAM9B,QAmMUwD,CAA6CnD,GAEzDsD,E,4MACJC,OAAS,kBACP,cAAC,IAAD,CAAUlC,MAAOA,EAAjB,SACE,cAAC6B,EAAD,O,YAH0B/B,IAAMC,WAQtCoC,IAASD,OAAO,cAACD,EAAD,IAAuBG,SAASC,eAAe,U","file":"static/js/main.0f9f733e.chunk.js","sourcesContent":["\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createStore } from 'redux';\r\nimport { devToolsEnhancer } from 'redux-devtools-extension';\r\nimport './style.css';\r\nimport { connect, Provider } from 'react-redux'\r\n\r\n//Redux\r\nconst MESSAGES = 'MESSAGES',\r\n  RESULT = 'RESULT',\r\n  CLEAR = 'CLEAR';\r\n\r\nconst addMessage = message => ({\r\n  type: MESSAGES,\r\n  message\r\n});\r\n\r\nconst addResult = () => ({\r\n  type: RESULT\r\n});\r\n\r\nconst clear = () => ({\r\n  type: CLEAR\r\n});\r\n\r\nconst INTIAL_STATE = ({\r\n  messages: [], // store operators and numbers\r\n  result: 0,\r\n  parser: '' //--123+ parse to messages:['-', '-123'], parser: '+'\r\n});\r\n\r\n\r\nconst calculatorReducer = (state = INTIAL_STATE, action) => {\r\n  let messages = [...state.messages];\r\n  let parser = state.parser;\r\n  switch (action.type) {\r\n    case MESSAGES:\r\n      if (messages.includes('=')) {\r\n        if (/[+*/-]/.test(action.message)) { //user previous result\r\n          messages = [state.result];\r\n        } else {\r\n          messages = []; //new calculation\r\n        }\r\n      }\r\n      parser += action.message;\r\n      //reset to last operator (case: +/* followed by any operator, or - followed by +*/)\r\n      if (/^[+/*-][+/*]/.test(parser)) {\r\n        parser = parser.substr(1);\r\n        //reset to last operator (case: -- foloweed by any operator)\r\n      } else if (/^[+*/-]-[+/*-]/.test(parser)) {\r\n        parser = parser.substr(2);\r\n      } else if (! /\\d+[+*/-]$/.test(parser)) {\r\n        // hanlde multiple zeros in beging of a number, allow 0. for float\r\n        if (/^[+*/]?-?0+$/.test(parser)) {\r\n          parser = parser.replace(/0+/, '0');\r\n        } else if (/^[+*/]?-?0+[1-9]$/.test(parser)) {\r\n          parser = parser.replace(/0+/, '');\r\n        }\r\n        // only show one dot for float number\r\n        if ((parser.match(/\\./g) || []).length > 1) {\r\n          parser = parser.substring(0, parser.length - 1);\r\n        }\r\n      } else {\r\n        //meet condition for parsing, ends with at least one digit and an operator\r\n        //at the very beginng, there might not be an operator in parser\r\n        if (/^[+/*-]/.test(parser)) {\r\n          messages.push(parser.charAt(0));\r\n          parser = parser.substring(1); //consume operator, '--1.23+' => '-1.23+' , messages:['-']\r\n        }\r\n        //continue consume parser number part, messages: ['-',-1.23], parser: '+'\r\n        if (parser.includes('.')) {\r\n          messages.push(parseFloat(parser.substring(0, parser.length - 1)));\r\n        } else {\r\n          messages.push(parseInt(parser.substring(0, parser.length - 1)));\r\n        }\r\n        //update parser for next parse\r\n        parser = parser.substring(parser.length - 1);\r\n      }\r\n      return { ...state, messages: messages, parser: parser, result: parser };\r\n    case RESULT:\r\n      //consume remaining parser if any\r\n      if (/^[+*/-]/.test(parser)) {\r\n        messages.push(parser.charAt(0));\r\n        parser = parser.substring(1);\r\n        if (parser.length > 0) {\r\n          if (parser.includes('.')) {\r\n            messages.push(parseFloat(parser));\r\n          } else {\r\n            messages.push(parseInt(parser));\r\n          }\r\n          parser = '';\r\n        }\r\n      }\r\n      // if there is no left hand for first operator in array, use 0\r\n      if (typeof messages[0] !== 'number') {\r\n        messages.unshift(0);\r\n      }\r\n      // no right hand number return current state\r\n      if (messages.length <= 2 || typeof messages[messages.length - 1] !== 'number') return state;\r\n\r\n      //calulate result Formula/Expression Logic\r\n      let reduced = [...messages];\r\n      while (reduced.includes('*') || reduced.includes('/')) {\r\n        let i = 1; // always start from beging as the array changes\r\n        while (i < reduced.length - 1) {\r\n          if (/[*|/]/.test(reduced[i])) {\r\n            let left = reduced[i - 1];\r\n            let operator = reduced[i];\r\n            let right = reduced[i + 1];\r\n            let result = operator === '*' ? Math.round(left * right * 10000) / 10000 : Math.round(left / right * 10000) / 10000;\r\n            reduced.splice(i - 1, 3, result);\r\n          }\r\n          i++;\r\n        }\r\n        console.log('reduced', reduced);\r\n      }\r\n\r\n      while (reduced.includes('+') || reduced.includes('-')) {\r\n        let i = 1;\r\n        while (i < reduced.length - 1) {\r\n          if (/[+|-]/.test(reduced[i])) {\r\n            let left = reduced[i - 1];\r\n            let operator = reduced[i];\r\n            let right = reduced[i + 1];\r\n            let result = operator === '+' ? Math.round((left + right) * 10000) / 10000 : Math.round((left - right) * 10000) / 10000;\r\n            reduced.splice(i - 1, 3, result)\r\n          }\r\n        }\r\n        i++;\r\n        console.log('reduced', reduced);\r\n      }\r\n      let result = reduced[0];\r\n      messages.push('=', result);\r\n      return { ...state, messages: messages, parser: '', result: result };\r\n    case CLEAR:\r\n      return INTIAL_STATE;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    messages: state.messages,\r\n    result: state.result,\r\n    parser: state.parser\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    addNewMessage: message => { dispatch(addMessage(message)) },\r\n    updateResult: () => { dispatch(addResult()) },\r\n    reset: () => { dispatch(clear()) }\r\n  }\r\n}\r\n\r\n//React\r\nclass Presentational extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.resetHandler = this.resetHandler.bind(this);\r\n    this.clickHandler = this.clickHandler.bind(this);\r\n    this.clickEqualsHandler = this.clickEqualsHandler.bind(this);\r\n  }\r\n\r\n  resetHandler = () => {\r\n    this.props.reset();\r\n  }\r\n\r\n  clickHandler = e => {\r\n    this.props.addNewMessage(e.target.value);\r\n  }\r\n\r\n  clickEqualsHandler = () => {\r\n    this.props.updateResult();\r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <div className=\"container\">\r\n        <div className='box-group'>\r\n          <div className=\"screen\">\r\n            <div id=\"formula\">{this.props.messages.join(\"\") + this.props.parser}</div>\r\n            <div id=\"display\">{this.props.result}</div>\r\n          </div>\r\n          <button id=\"clear\" onClick={this.resetHandler}>AC</button>\r\n          <button id=\"divide\" onClick={this.clickHandler} value=\"/\">/</button>\r\n          <button id=\"multiply\" onClick={this.clickHandler} value=\"*\">*</button>\r\n\r\n          <button id=\"seven\" onClick={this.clickHandler} value=\"7\">7</button>\r\n          <button id=\"eight\" onClick={this.clickHandler} value=\"8\">8</button>\r\n          <button id=\"nine\" onClick={this.clickHandler} value=\"9\">9</button>\r\n          <button id=\"add\" onClick={this.clickHandler} value=\"+\">+</button>\r\n\r\n          <button id=\"four\" onClick={this.clickHandler} value=\"4\">4</button>\r\n          <button id=\"five\" onClick={this.clickHandler} value=\"5\">5</button>\r\n          <button id=\"six\" onClick={this.clickHandler} value=\"6\">6</button>\r\n          <button id=\"subtract\" onClick={this.clickHandler} value=\"-\">-</button>\r\n\r\n          <button id=\"one\" onClick={this.clickHandler} value=\"1\">1</button>\r\n          <button id=\"two\" onClick={this.clickHandler} value=\"2\">2</button>\r\n          <button id=\"three\" onClick={this.clickHandler} value=\"3\">3</button>\r\n\r\n          <button id=\"equals\" onClick={this.clickEqualsHandler}>=</button>\r\n          <button id=\"zero\" onClick={this.clickHandler} value=\"0\">0</button>\r\n          <button id=\"decimal\" onClick={this.clickHandler} value=\".\">.</button>\r\n        </div>\r\n        <p>Coded by Yong Xia <a href=\"https://github.com/yongxia/js-calculator\" target=\"_blank\" rel=\"noreferrer\"><i className=\"fa fa-github\"></i> Github</a></p>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n//react-dedux\r\nconst store = createStore(calculatorReducer, devToolsEnhancer());\r\nconst Container = connect(mapStateToProps, mapDispatchToProps)(Presentational);\r\n\r\nclass CalculatorWrapper extends React.Component {\r\n  render = () => (\r\n    <Provider store={store}>\r\n      <Container />\r\n    </Provider>\r\n  )\r\n}\r\n\r\nReactDOM.render(<CalculatorWrapper />, document.getElementById('root'))"],"sourceRoot":""}